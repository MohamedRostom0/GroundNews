The German parliament has rejected immigration measures put forward by the conservative opposition and backed by the far-right.
Christian Democratic Union (CDU) leader Friedrich Merz, who is tipped to be Germany's next chancellor, had tried to rely on support from the Alternative for Germany (AfD) party for the second time in a week - but the bill was defeated by 350 votes to 338.
The strategy was widely condemned, including by Merz's predecessor as CDU leader and former chancellor Angela Merkel, who accused him of turning his back on a previous pledge not to work with AfD in the Bundestag.
Merz defended his actions as "necessary" and said he had not sought the party's support.
"A right decision doesn't become wrong just because the wrong people agree to it," he said.
The CDU leader had been hoping that a tougher stance on migration would win over supporters of the AfD - but his reliance on that party for this vote risks losing more moderate voters.
Thousands of people took to the streets of Germany on Thursday night in opposition to the CDU's cooperation with the far-right.
The CDU is leading in the polls ahead of Germany's snap election next month. The AfD is currently polling in second place, although Merz has ruled out any kind of coalition with them.
Wednesday's vote saw a non-binding motion over changes to immigration law pass through parliament. Friday's vote was on draft legislation which was aimed at curbing immigration numbers and family reunion rights.
The proposed legislation was opposed by parties including current Chancellor Olaf Scholz's Social Democrats (SPD). Scholz is among those to have criticised Merz's reliance on the AfD, calling it an "unforgivable mistake".
"Since the founding of the Federal Republic of Germany over 75 years ago, there has always been a clear consensus among all democrats in our parliaments: we do not make common cause with the far-right," he said.
In a rare political intervention, Merkel said Merz was breaking a pledge made in November to work with the SDP and the Greens to pass legislation, not the AfD. She described the pledge as an "expression of great state political responsibility".
On Wednesday, Alice Weidel, the leader of the AfD, accused mainstream parties of disrespecting German voters by refusing to work with her party.
Sections of the AfD have been classed as right-wing extremists by domestic intelligence.
Germany's already fraught debate on immigration has flared up following a series of fatal attacks where the suspect is an asylum seeker, most recently in the city of Aschaffenburg.
It has become a central issue in campaigning for the election, which was triggered by the collapse of Scholz's governing coalition.
The protests came after some parties voted alongside the far-right party, Alternative for Germany (AfD), over a non-binding resolution on immigration last week.
The former chancellor's comments come after the CDU put forward a proposal which was supported by the far-right AfD.
Germany's Bundestag descends into recrimination after a "firewall" against working with the far-right cracks.
Projections suggest the UK population could grow by almost five million over the next decade.
Trump and Modi spoke on Monday, their first interaction since the US president took office last week.
Copyright 2025 BBC. All rights reserved.  The BBC is not responsible for the content of external sites. Read about our approach to external linking.